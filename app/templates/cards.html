{% load static %}
{% load humanize %}
{% load custom_filters %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="description" content="Nextcoin">
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="keywords" content="HTML,CSS,JavaScript">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <title>ExchangeVista </title>
    <!-- Google font file -->
    <link href="https://fonts.googleapis.com/css?family=Nunito:300,400,600,700,900" rel="stylesheet">
    <!-- Favicon-->
    <link rel="icon" href="{% static 'img/favicon.png' %}">
    <link rel="apple-touch-icon" href="{% static 'img/touch/homescreen96.png' %}">
    <link rel="apple-touch-icon" sizes="144x144" href="{% static 'img/touch/homescreen144.png' %}">
    <link rel="apple-touch-icon" sizes="168x168" href="{% static 'img/touch/homescreen168.png' %}">
    <link rel="apple-touch-icon" sizes="192x192" href="{% static 'img/touch/homescreen192.png' %}">
    <!-- Stylesheet-->

    <!-- Offcanvas stylesheets-->
    <link rel="stylesheet" href="{% static 'css/offcanvas.css' %}" type="text/css" media="all" />
    <link rel="stylesheet" type="text/css" href="{% static 'fonts/bootstrap-icons.css' %}">
    <!-- Ends here -->
    <!-- FontAwesome CDN -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Ends here -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" type="text/css" media="all" />
    <link rel="stylesheet" href="{% static 'css/animate.min.css' %}" type="text/css" media="all" />
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}" type="text/css" media="all" />
    <link rel="stylesheet" href="{% static 'css/jquery.jConveyorTicker.min.css' %}" type="text/css" media="all" />
    <link rel="stylesheet" href="{% static 'css/style.css' %}" type="text/css" media="all" />
    <!-- Web App Manifest-->
    <link rel="manifest" href="{% static 'manifest.json' %}">
</head>
<body>
<!-- Header Section -->
<header class="header-main">
    <div class="container">
        <div class="content-header d-flex align-items-center justify-content-between">
            <div class="navbar-menu-toggler navbar-btn">
                <a href="javascript:history.back()">
                    <svg version="1.1" width="18" height="18" fill="currentColor" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
                        viewBox="0 0 492 492" style="enable-background:new 0 0 492 492;" xml:space="preserve">
                        <path d="M198.608,246.104L382.664,62.04c5.068-5.056,7.856-11.816,7.856-19.024c0-7.212-2.788-13.968-7.856-19.032l-16.128-16.12
                    			C361.476,2.792,354.712,0,347.504,0s-13.964,2.792-19.028,7.864L109.328,227.008c-5.084,5.08-7.868,11.868-7.848,19.084
                    			c-0.02,7.248,2.76,14.028,7.848,19.112l218.944,218.932c5.064,5.072,11.82,7.864,19.032,7.864c7.208,0,13.964-2.792,19.032-7.864
                    			l16.124-16.12c10.492-10.492,10.492-27.572,0-38.06L198.608,246.104z"/>
                    </svg>
                </a>
            </div>
            <div class="item-options">
                {% if notifications %}
                <div class="item-notification icon-effect me-3">
                    <a href="{% url 'notifications' %}">
                        <svg enable-background="new 0 0 512 512" fill="currentColor" viewBox="0 0 512 512" width="20" height="20"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="m411 262.862v-47.862c0-69.822-46.411-129.001-110-148.33v-21.67c0-24.813-20.187-45-45-45s-45 20.187-45 45v21.67c-63.59 19.329-110 78.507-110 148.33v47.862c0 61.332-23.378 119.488-65.827 163.756-4.16 4.338-5.329 10.739-2.971 16.267s7.788 9.115 13.798 9.115h136.509c6.968 34.192 37.272 60 73.491 60 36.22 0 66.522-25.808 73.491-60h136.509c6.01 0 11.439-3.587 13.797-9.115s1.189-11.929-2.97-16.267c-42.449-44.268-65.827-102.425-65.827-163.756zm-170-217.862c0-8.271 6.729-15 15-15s15 6.729 15 15v15.728c-4.937-.476-9.94-.728-15-.728s-10.063.252-15 .728zm15 437c-19.555 0-36.228-12.541-42.42-30h84.84c-6.192 17.459-22.865 30-42.42 30zm-177.67-60c34.161-45.792 52.67-101.208 52.67-159.138v-47.862c0-68.925 56.075-125 125-125s125 56.075 125 125v47.862c0 57.93 18.509 113.346 52.671 159.138z" />
                            <path
                                d="m451 215c0 8.284 6.716 15 15 15s15-6.716 15-15c0-60.1-23.404-116.603-65.901-159.1-5.857-5.857-15.355-5.858-21.213 0s-5.858 15.355 0 21.213c36.831 36.831 57.114 85.8 57.114 137.887z" />
                            <path
                                d="m46 230c8.284 0 15-6.716 15-15 0-52.086 20.284-101.055 57.114-137.886 5.858-5.858 5.858-15.355 0-21.213-5.857-5.858-15.355-5.858-21.213 0-42.497 42.497-65.901 98.999-65.901 159.099 0 8.284 6.716 15 15 15z" />
                        </svg>
                        <span class="count-notif"></span>
                    </a>
                </div>
                {% else %}
                <div class="item-notification me-3">
                    <a href="{% url 'notifications' %}">
                        <svg enable-background="new 0 0 512 512" fill="currentColor" viewBox="0 0 512 512" width="20" height="20"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="m411 262.862v-47.862c0-69.822-46.411-129.001-110-148.33v-21.67c0-24.813-20.187-45-45-45s-45 20.187-45 45v21.67c-63.59 19.329-110 78.507-110 148.33v47.862c0 61.332-23.378 119.488-65.827 163.756-4.16 4.338-5.329 10.739-2.971 16.267s7.788 9.115 13.798 9.115h136.509c6.968 34.192 37.272 60 73.491 60 36.22 0 66.522-25.808 73.491-60h136.509c6.01 0 11.439-3.587 13.797-9.115s1.189-11.929-2.97-16.267c-42.449-44.268-65.827-102.425-65.827-163.756zm-170-217.862c0-8.271 6.729-15 15-15s15 6.729 15 15v15.728c-4.937-.476-9.94-.728-15-.728s-10.063.252-15 .728zm15 437c-19.555 0-36.228-12.541-42.42-30h84.84c-6.192 17.459-22.865 30-42.42 30zm-177.67-60c34.161-45.792 52.67-101.208 52.67-159.138v-47.862c0-68.925 56.075-125 125-125s125 56.075 125 125v47.862c0 57.93 18.509 113.346 52.671 159.138z" />
                            <path
                                d="m451 215c0 8.284 6.716 15 15 15s15-6.716 15-15c0-60.1-23.404-116.603-65.901-159.1-5.857-5.857-15.355-5.858-21.213 0s-5.858 15.355 0 21.213c36.831 36.831 57.114 85.8 57.114 137.887z" />
                            <path
                                d="m46 230c8.284 0 15-6.716 15-15 0-52.086 20.284-101.055 57.114-137.886 5.858-5.858 5.858-15.355 0-21.213-5.857-5.858-15.355-5.858-21.213 0-42.497 42.497-65.901 98.999-65.901 159.099 0 8.284 6.716 15 15 15z" />
                        </svg>
                    </a>
                </div>
                {% endif %}
                <div class="avatar-item">
                    <a href="{% url 'profile' %}"><img src="{{ dp }}"></a>
                </div>
            </div>
        </div>
    </div>
</header>
<!-- Main Section -->
<main class="main-content">
    <div class="container">
        <h3 class="mb-4">My Cards</h3>
        <div class="owl-carousel main-slider">
            {% if cards %}
            {% for card in cards %}
            <a data-bs-toggle="offcanvas" data-bs-target="#card-menu" href="#">
                <div class="item-card">
                    <div class="card-content bg-success">
                        <div class="logo-card">
                            {% if card.card_number|startswith:"5190" %}
                            <img src="{% static 'img/icons/mastercard.png' %}" alt="logo">
                            {% elif card.card_number|startswith:"4040" %}
                            <img src="{% static 'img/icons/symbols.png' %}" alt="logo">
                            {% elif card.card_number|startswith:"5922" %}
                            <img src="{% static 'img/icons/mastercard.png' %}" alt="logo">
                            {% elif card.card_number|startswith:"4139" %}
                            <img src="{% static 'img/icons/symbols.png' %}" alt="logo">
                            {% endif %}
                        </div>
                        <span>Balance </span>
                        <h2 class="text-light">£{{ card.available_amount|intcomma }}</h2>
                        <h5 class="text-light text-end">{{card.card_number|format_number}}</h5>
                        <div class="card-info d-flex mt-4">
                            <div class="info-holder">
                                <span>Card Holder</span>
                                <h4 class="text-light">{{ card.card_holder }}</h4>
                            </div>
                            <div class="info-exp ms-5">
                                <span>Expires</span>
                                <h4 class="text-light">{{card.expiry_date|date:"m/Y"}}</h4>
                            </div>
                            <div class="info-Verifi ms-6">
                                <span>CVV</span>
                                <h4 class="text-light">{{ card.cvv}}</h4>
                            </div>
                
                        </div>
                    </div>
                </div>
            </a>
            {% endfor %}
            {% else %}
            <a data-bs-toggle="offcanvas" data-bs-target="#request-card" href="#">
                <div id="generic-card" class="item-card">
                    <div class="card-content bg-danger">
                        <div class="logo-card">
                            <img src="{% static 'img/icons/mastercard.png' %}" alt="logo">
                        </div>
                        <span>Not Activated</span>
                        <h2 class="text-light">£10</h2>
                        <h5 class="text-light text-end">1234 5678 9101 1131</h5>
                        <div class="card-info d-flex mt-4">
                            <div class="info-holder">
                                <span>Card Holder</span>
                                <h4 class="text-light">Generic Card</h4>
                            </div>
                            <div class="info-exp ms-5">
                                <span>Expires</span>
                                <h4 class="text-light">08/27</h4>
                            </div>
                            <div class="info-Verifi ms-6">
                                <span>CVV</span>
                                <h4 class="text-light">552</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </a>
            {% endif %}
        </div>
        {% if cards %}
            <h6 style="min-width: 400px; opacity: 0.4;" class="text-center mt-4">Click the card to open and manage your card preferences</h6>
        {% else %}
            <h6 style="min-width: 400px; opacity: 0.4;" class="text-center mt-4">To request a new card, click on the generic card above</h6>
        {% endif %}

    </div>
    <!-- Activity History Section-->
    <div class="transaction-item">
            <h4 class="main-title py-4">Activity History</h4>
            <div class="transcation-card">
                <ul class="transaction-list">
                    <hr>
                    {% if activities %}
                        {% for activity in activities %}
                            <li class="list-item mb-0 pb-3">
                                <div class="media align-items-center">
                                    <img src="{% static 'img/icons/chainlink.png' %}" alt="coin image">
                                    <div class="media-body">
                                        <h5 class="{% if activity.activity_type == 'Card Funding' %}text-success{% elif activity.activity_type == 'Card Offload' or activity.activity_type == 'Card Deletion' %}text-danger{% endif %} mb-1 fs-16">{{ activity.activity_type }}</h5>
                                        <p style="max-width: 250px;" class="mb-0 text-gray">{{ activity.activity_description }} </p>
                                    </div>
                                </div>
                                <div class="text-right ms-auto">
                                    <p class="mb-1">{{ activity.date|time_since }}</p>

                                        {% if activity.activity_type == 'Card Funding' %}
                                            <p class="mb-0 fw-bold"><span class="text-success">+£{{ activity.activity_value|intcomma }} </span></p>
                                        {% elif activity.activity_type == 'Card Offload' %}
                                        <p class="mb-0 fw-bold"><span class="text-danger">-£{{ activity.activity_value|intcomma }} </span></p>

                                     {% endif %}
                                </div>
                            </li>
                            <hr>
                        {% endfor %}
                    {% else %} 
                        <li class="list-item mb-0 pb-3">
                            <div class="media align-items-center">
                                <img src="{% static 'img/icons/chainlink.png' %}" alt="coin image">
                                <div class="media-body">
                                    <h5 class="mb-1 fs-16"></h5>
                                    <p class="mb-0 text-gray"></p>
                                </div>
                            </div>
                            <div class="text-right ms-auto">
                                <p class="mb-1 fw-bold">Here, you will see all your card related activities.</p>
                            </div>
                        </li>
                    {% endif %}
                </ul>
            </div>
    </div>
</main>

<!-- Card Menu  Canvas-->
<div id="card-menu" style="min-height:380px; overflow: auto;"
    class="offcanvas offcanvas-bottom rounded-m offcanvas-detached">
    <form method="post">
        <div class="d-flex m-3">
            <div class="align-self-center">
                <h2 class="font-700 mb-0">Preferences </h2>
                <p> Manage your card preferences through this modal</p>
            </div>
            <div class="align-self-center ms-auto">
                <a href="#" class="icon icon-xs me-n2" data-bs-dismiss="offcanvas">
                    <i class="bi bi-x-circle-fill color-yellow-dark font-16"></i>
                </a>
            </div>
        </div>
        <div class="content mt-0">
            <div class="input-group mb-3">
                <input id="funding" data-bs-toggle="offcanvas" data-bs-target="#funding-menu" type="button"
                    value="Fund Card" class="btn btn-main shadow-bg shadow-bg-xs" style="width: 100%;">
            </div>
            <div class="input-group mb-3">
                <input id="withdrawal" data-bs-toggle="offcanvas" data-bs-target="#offloading-menu" type="button" value="Offload Card" class="btn btn-main shadow-bg shadow-bg-xs"
                    style="width: 100%;">
            </div>
            <div class="input-group mb-3">
                <div style="width: 100%; border-radius: 10px;"
                    class="bg-dark list-group-item d-flex justify-content-between align-items-center mb-3">
                    <h5 class="fs-16">Activate/Deactivate Card</h5>
                    <div class="form-check form-switch">
                        {% for x in cards %}
                            {% if x.card_status == 'Activated' %}
                                <input id="toggle-card" class="form-check-input" checked type="checkbox">
                            {% else %}
                                <input id="toggle-card" class="form-check-input" type="checkbox">
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>
            </div>
            <div class="mb-1" style="display: flex; justify-content: center; align-items: center;">
                <i style="color: red;" class="fas fa-xl fa-beat fa-exclamation-triangle"></i>
            </div>
            <p class="text-center text-danger">Danger Zone</p>
            <div class="input-group mb-3">
                <input data-id="{% for x in cards %} {{ x.id }} {% endfor %}" id="delete" type="button" value="Delete Card" class="btn btn-danger shadow-bg shadow-bg-xs"
                    style="background-color: crimson !important; width: 100%;">
            </div>
            <!-- <button id="get-card" style="width: 100%;" type="submit"
                class="btn btn-main shadow-bg shadow-bg-xs">Submit</button> -->
            <!-- preloader -->
            <div id="loader" style="display: none; justify-content: center; align-items: center;">
                <div class="loader" id="line">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            <!-- ends here -->
        </div>
    </form>
</div>
<!-- Card funding Canvas -->
<div id="funding-menu" style="min-height:380px; overflow: auto;"
    class="offcanvas offcanvas-bottom rounded-m offcanvas-detached">
    <form method="post">
        {% csrf_token %}
        <div class="d-flex m-3">
            <div class="align-self-center">
                <h2 class="font-700 mb-0">Fund Card</h2>
            </div>
            <div class="align-self-center ms-auto">
                <a href="#" class="icon icon-xs me-n2" data-bs-toggle="offcanvas" data-bs-target="#card-menu">
                    <i class="bi bi-x-circle-fill color-yellow-dark font-16"></i>
                </a>
            </div>
        </div>
        <div class="content mt-0">
            <div class="input-group mb-3">
                <select id="funding-account" name="funding-account" class="btn btn-main shadow-bg shadow-bg-xs" style="width: 100%;">
                    <option selected disabled value="">Select Account</option>
                    <option value="deposit">Deposit Account</option>
                    <option value="profits">Profits Account</option>
                </select>
                <small class="text-warning">Select the account you want to fund your card from</small>
            </div>
            <div class="input-group mb-3">
                <input id="funding-amount" name="funding-amount" placeholder="Enter Amount to fund your card" type="number" class="form-control" style="width: 100%;">
                <small class="text-warning">Enter the amount you want to fund your card with</small>
            </div>
            <button id="fundCard" style="width: 100%;" type="submit"
                class="btn btn-success shadow-bg shadow-bg-xs">Fund Card</button>
            <!-- preloader -->
            <div id="funding-loader" style="display: none; justify-content: center; align-items: center;">
                <div class="loader" id="line">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            <!-- ends here -->
        </div>
    </form>
</div>

<!-- Card offloading Canvas -->
<div id="offloading-menu" style="min-height:380px; overflow: auto;"
    class="offcanvas offcanvas-bottom rounded-m offcanvas-detached">
    <form method="post">
        <div class="d-flex m-3">
            <div class="align-self-center">
                <h2 class="font-700 mb-0">Offload Card</h2>
            </div>
            <div class="align-self-center ms-auto">
                <a href="#" class="icon icon-xs me-n2" data-bs-toggle="offcanvas" data-bs-target="#card-menu">
                    <i class="bi bi-x-circle-fill color-yellow-dark font-16"></i>
                </a>
            </div>
        </div>
        <div class="content mt-0">
            <div class="input-group mb-3">
                <select name="offloading-account" id="offloading-account" class="btn btn-main shadow-bg shadow-bg-xs" style="width: 100%;">
                    <option selected disabled value="">Select Account</option>
                    <option value="deposit">Deposit Account</option>
                    <option value="profits">Profits Account</option>
                </select>
                <small class="text-warning">Select the account you want to offload your card balance to. </small>
            </div>
            <div class="input-group mb-3">
                <input id="offloading-amount" placeholder="Enter the amount you want to offload" type="number" class="form-control" style="width: 100%;">
                <small class="text-warning">Enter the amount you want to offload</small>
            </div>
            <button id="offloadCard" style="width: 100%;" type="submit"
                class="btn btn-danger shadow-bg shadow-bg-xs">Offload Card</button>
            <!-- preloader -->
            <div id="offload-loader" style="display: none; justify-content: center; align-items: center;">
                <div class="loader" id="line">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            <!-- ends here -->
        </div>
    </form>
</div>

<!-- Card request Canvas -->
<div id="request-card" style="height:380px;" class="offcanvas offcanvas-bottom rounded-m offcanvas-detached">
    <form id="card-form">
        <div class="d-flex m-3">
            <div class="align-self-center">
                <h2 class="font-700 mb-0">Request card</h2>
                <p>Enjoy fast and safe withdrawals / payments directly from your Vista wallet. Activate a card and go limitless in payments!
                </p>
            </div>
            <div class="align-self-center ms-auto">
                <a href="#" class="icon icon-xs me-n2" data-bs-dismiss="offcanvas">
                    <i class="bi bi-x-circle-fill color-yellow-dark font-16"></i>
                </a>
            </div>
        </div>
        <div class="content mt-0">
            <div class="input-group mb-3">
                <input name="name" type="text" class="form-control"
                    placeholder="Enter the card holder's full name. surname first">
                <div class="input-group-append">
                    <span class="input-group-text">Card holder's name</span>
                </div>
            </div>
            <div class="input-group mb-3">
                <input name="amount" type="number" class="form-control" placeholder="Enter amount to fund card with">
                <div class="input-group-append">
                    <span class="input-group-text">Fund card with</span>
                </div>
            </div>
            <button id="get-card" style="width: 100%;" type="submit"
                class="btn btn-main shadow-bg shadow-bg-xs">Submit</button>
            <!-- preloader -->
            <div id="get-card-loader" style="display: none; justify-content: center; align-items: center;">
                <div class="loader" id="line">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            <!-- ends here -->
        </div>
    </form>
</div>

<!--Server Response OffCanvas -->
<div id="response-canvas" style="height:auto;" class="offcanvas offcanvas-top rounded-m offcanvas-detached">
    <div class="d-flex m-3">
        <div class="align-self-center">
            <h6 class="text-secondary font-300 mb-0">System response</h6>
        </div>
        <div class="align-self-center ms-auto">
            <a href="#" class="text-primary icon icon-xs me-n2" data-bs-dismiss="offcanvas">
                <i class="bi bi-x-circle-fill text-primary font-16"></i>
            </a>
        </div>
    </div>
    <div class="content mt-0">
        <h4 id="message" class="message text-primary mb-4">

        </h4>
        <br>
        <a style="min-width: 100%;" href="#" data-bs-dismiss="offcanvas" class="btn btn-main  shadow-bg-xs">Dismiss!</a>
    </div>
</div>
<!-- Ends here -->

<!-- Authorization Offcanvas-->
<div id="action-canvas" style="width:320px; max-height: 500px !important;"
    class="offcanvas offcanvas-modal rounded-m offcanvas-detached">
    <div class="d-flex m-3">
        <div class="align-self-center">
            <h5 class="font-400 mb-0">Authorization Center</h5>
            <small class="text-warning">Please enter your transaction PIN to proceed</small>
        </div>
        <div class="align-self-center ms-auto">
            <a href="#" class="icon icon-xs me-n2" data-bs-dismiss="offcanvas">
                <i class="bi bi-x-circle-fill color-yellow-dark font-16"></i>
            </a>
        </div>
    </div>
    <div class="content mt-0 py-4">
        <div class="input-group mb-3">
            <input id="pin-input" type="password" class="form-control" placeholder="Enter your transaction Pin">
        </div>
        <a id="action-button" style="min-width: 100%;" class="btn btn-main  shadow-bg-xs">Authorize!</a>
    </div>
</div>
<!-- Authorization Offcanvas ends here -->

<!-- Success Offcanvas here -->
<div id="success-canvas" style="width:320px; max-height: 500px !important;"
    class="offcanvas offcanvas-modal rounded-m offcanvas-detached">
    <div class="d-flex m-3">
        <div class="align-self-center">
            <h5 class="font-400 mb-0">System Response</h5>
        </div>
        <div class="align-self-center ms-auto">
            <a href="#" class="icon icon-xs me-n2" data-bs-dismiss="offcanvas">
                <i class="bi bi-x-circle-fill color-yellow-dark font-16"></i>
            </a>
        </div>
    </div>
    <div class="content mt-0 py-4">
        <h6 class="text-success message"></h6>
        <a id="success-button" style="min-width: 100%;" class="btn btn-main  shadow-bg-xs">Awesome!</a>
    </div>
</div>
<!-- Footer Section-->
<footer>
    <div class="container">
        <div class="footer-bar">
            <a href="{% url 'home' %}">
                <svg viewBox="0 1 511 511.999" width="20" height="20" fill="currentColor"
                    xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="m498.699219 222.695312c-.015625-.011718-.027344-.027343-.039063-.039062l-208.855468-208.847656c-8.902344-8.90625-20.738282-13.808594-33.328126-13.808594-12.589843 0-24.425781 4.902344-33.332031 13.808594l-208.746093 208.742187c-.070313.070313-.144532.144531-.210938.214844-18.28125 18.386719-18.25 48.21875.089844 66.558594 8.378906 8.382812 19.441406 13.234375 31.273437 13.746093.484375.046876.96875.070313 1.457031.070313h8.320313v153.695313c0 30.417968 24.75 55.164062 55.167969 55.164062h81.710937c8.285157 0 15-6.71875 15-15v-120.5c0-13.878906 11.292969-25.167969 25.171875-25.167969h48.195313c13.878906 0 25.167969 11.289063 25.167969 25.167969v120.5c0 8.28125 6.714843 15 15 15h81.710937c30.421875 0 55.167969-24.746094 55.167969-55.164062v-153.695313h7.71875c12.585937 0 24.421875-4.902344 33.332031-13.8125 18.359375-18.367187 18.367187-48.253906.027344-66.632813zm-21.242188 45.421876c-3.238281 3.238281-7.542969 5.023437-12.117187 5.023437h-22.71875c-8.285156 0-15 6.714844-15 15v168.695313c0 13.875-11.289063 25.164062-25.167969 25.164062h-66.710937v-105.5c0-30.417969-24.746094-55.167969-55.167969-55.167969h-48.195313c-30.421875 0-55.171875 24.75-55.171875 55.167969v105.5h-66.710937c-13.875 0-25.167969-11.289062-25.167969-25.164062v-168.695313c0-8.285156-6.714844-15-15-15h-22.328125c-.234375-.015625-.464844-.027344-.703125-.03125-4.46875-.078125-8.660156-1.851563-11.800781-4.996094-6.679688-6.679687-6.679688-17.550781 0-24.234375.003906 0 .003906-.003906.007812-.007812l.011719-.011719 208.847656-208.839844c3.234375-3.238281 7.535157-5.019531 12.113281-5.019531 4.574219 0 8.875 1.78125 12.113282 5.019531l208.800781 208.796875c.03125.03125.066406.0625.097656.09375 6.644531 6.691406 6.632813 17.539063-.03125 24.207032zm0 0" />
                </svg> Home
            </a>
            <a href="{% url 'wallet' %}">
                <svg fill="currentColor" width="20" height="20" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
                    viewBox="0 0 469.341 469.341" xml:space="preserve">
                    <path d="M448.004,236.639v-65.965c0-22.368-17.35-40.559-39.271-42.323l-61.26-107c-5.677-9.896-14.844-16.969-25.813-19.906
                c-10.917-2.917-22.333-1.385-32.104,4.302L79.553,128.007H42.67c-23.531,0-42.667,19.135-42.667,42.667v256
                c0,23.531,19.135,42.667,42.667,42.667h362.667c23.531,0,42.667-19.135,42.667-42.667v-65.965
                c12.389-4.418,21.333-16.147,21.333-30.035v-64C469.337,252.786,460.393,241.057,448.004,236.639z M383.944,128.007h-92.971
                l69.729-40.596L383.944,128.007z M350.103,68.898l-101.529,59.109h-42.113l133.112-77.5L350.103,68.898z M300.295,24.184
                c4.823-2.823,10.458-3.573,15.844-2.135c5.448,1.458,9.99,4.979,12.813,9.906l0.022,0.039l-164.91,96.013h-42.111L300.295,24.184
                z M426.67,426.674c0,11.76-9.573,21.333-21.333,21.333H42.67c-11.76,0-21.333-9.573-21.333-21.333v-256
                c0-11.76,9.573-21.333,21.333-21.333h362.667c11.76,0,21.333,9.573,21.333,21.333v64h-64c-35.292,0-64,28.708-64,64
                c0,35.292,28.708,64,64,64h64V426.674z M448.004,330.674c0,5.885-4.781,10.667-10.667,10.667H362.67
                c-23.531,0-42.667-19.135-42.667-42.667c0-23.531,19.135-42.667,42.667-42.667h74.667c5.885,0,10.667,4.781,10.667,10.667
                V330.674z" />
                    <path d="M362.67,277.341c-11.76,0-21.333,9.573-21.333,21.333c0,11.76,9.573,21.333,21.333,21.333
                c11.76,0,21.333-9.573,21.333-21.333C384.004,286.914,374.431,277.341,362.67,277.341z" />
                </svg> Wallet
            </a>
            <a href="{% url 'markets' %}">
                <svg fill="currentColor" width="20" height="20" xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 375.148 375.148"
                    style="enable-background:new 0 0 375.148 375.148;" xml:space="preserve">
                    <path d="M222.076,218.936h-68.963c-5.771,0-10.449,4.678-10.449,10.449v135.314c0,5.771,4.678,10.449,10.449,10.449h68.963
                c5.771,0,10.449-4.678,10.449-10.449V229.385C232.525,223.614,227.847,218.936,222.076,218.936z M211.627,354.25h-48.065V239.834
                h48.065V354.25z" />
                    <path d="M358.958,136.911h-69.486c-5.771,0-10.449,4.678-10.449,10.449v217.339c0,5.771,4.678,10.449,10.449,10.449h69.486
                c5.771,0,10.449-4.678,10.449-10.449V147.36C369.407,141.59,364.729,136.911,358.958,136.911z M348.509,354.25h-48.588V157.809
                h48.588V354.25z" />
                    <path d="M85.717,269.613H16.231c-5.771,0-10.449,4.678-10.449,10.449v84.637c0,5.771,4.678,10.449,10.449,10.449h69.486
                c5.771,0,10.449-4.678,10.449-10.449v-84.637C96.166,274.292,91.488,269.613,85.717,269.613z M75.268,354.25H26.68v-63.739
                h48.588V354.25z" />
                    <path d="M370.452,10.479c-1.589-2.19-4.089-3.536-6.792-3.657L268.574,0.03c-5.771-0.433-10.8,3.895-11.233,9.665
                c-0.433,5.771,3.894,10.8,9.665,11.233l67.297,4.57l-123.721,96.786l-94.563-74.188c-4.038-3.198-9.803-2.976-13.584,0.522
                L5.26,141.613c-4.131,3.919-4.363,10.425-0.522,14.629c1.864,2.419,4.786,3.783,7.837,3.657c2.756-0.039,5.385-1.166,7.314-3.135
                l90.384-86.727l93.518,73.665c3.817,3.056,9.244,3.056,13.061,0L350.601,39.624l-5.227,64.896
                c-0.026,5.674,4.279,10.431,9.927,10.971h0.522c5.386,0.027,9.91-4.045,10.449-9.404l6.792-88.294
                C373.447,15.074,372.471,12.34,370.452,10.479z" />
                </svg> Markets
            </a>
            <a href="{% url 'cards' %}" class="active">
                <svg width="20" height="20" fill="currentColor" viewBox="0 0 512.002 512.002"
                    xmlns="http://www.w3.org/2000/svg">
                    <g>
                        <path
                            d="m502.903 96.829c-6.634-7.842-15.924-12.632-26.161-13.487l-360.557-30.106c-10.238-.855-20.192 2.328-28.035 8.961-7.811 6.607-12.594 15.85-13.476 26.037l-7.254 68.056h-28.965c-21.204 0-38.455 17.251-38.455 38.455v225.702c0 21.204 17.251 38.455 38.455 38.455h361.813c21.205 0 38.456-17.251 38.456-38.455v-36.613l12.839 1.072c1.083.09 2.16.135 3.228.135 19.768 0 36.62-15.209 38.294-35.257l18.781-224.919c.854-10.237-2.329-20.193-8.963-28.036zm-464.448 79.461h361.813c10.176 0 18.456 8.279 18.456 18.455v20.566h-398.724v-20.566c0-10.176 8.279-18.455 18.455-18.455zm-18.455 59.021h398.724v41.489h-398.724zm380.268 203.591h-361.813c-10.176 0-18.455-8.279-18.455-18.455v-123.647h398.724v123.647c0 10.176-8.28 18.455-18.456 18.455zm91.667-315.702-18.781 224.919c-.847 10.141-9.788 17.706-19.927 16.856l-14.503-1.211v-169.019c0-21.204-17.251-38.455-38.456-38.455h-312.734l7.039-66.04c.008-.076.015-.151.021-.228.847-10.141 9.783-17.705 19.927-16.855l360.558 30.106c4.913.41 9.372 2.709 12.555 6.473s4.711 8.541 4.301 13.454z" />
                        <path
                            d="m376.873 326.532h-96.242c-5.523 0-10 4.477-10 10v62.789c0 5.523 4.477 10 10 10h96.242c5.523 0 10-4.477 10-10v-62.789c0-5.523-4.477-10-10-10zm-10 62.789h-76.242v-42.789h76.242z" />
                    </g>
                </svg> My Cards
            </a>
            <a href="{% url 'profile' %}">
                <svg viewBox="-42 0 512 512.001" width="20" height="20" fill="currentColor"
                    xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="m210.351562 246.632812c33.882813 0 63.21875-12.152343 87.195313-36.128906 23.96875-23.972656 36.125-53.304687 36.125-87.191406 0-33.875-12.152344-63.210938-36.128906-87.191406-23.976563-23.96875-53.3125-36.121094-87.191407-36.121094-33.886718 0-63.21875 12.152344-87.191406 36.125s-36.128906 53.308594-36.128906 87.1875c0 33.886719 12.15625 63.222656 36.128906 87.195312 23.980469 23.96875 53.316406 36.125 87.191406 36.125zm-65.972656-189.292968c18.394532-18.394532 39.972656-27.335938 65.972656-27.335938 25.996094 0 47.578126 8.941406 65.976563 27.335938 18.394531 18.398437 27.339844 39.980468 27.339844 65.972656 0 26-8.945313 47.578125-27.339844 65.976562-18.398437 18.398438-39.980469 27.339844-65.976563 27.339844-25.992187 0-47.570312-8.945312-65.972656-27.339844-18.398437-18.394531-27.34375-39.976562-27.34375-65.976562 0-25.992188 8.945313-47.574219 27.34375-65.972656zm0 0" />
                    <path
                        d="m426.128906 393.703125c-.691406-9.976563-2.089844-20.859375-4.148437-32.351563-2.078125-11.578124-4.753907-22.523437-7.957031-32.527343-3.3125-10.339844-7.808594-20.550781-13.375-30.335938-5.769532-10.15625-12.550782-19-20.160157-26.277343-7.957031-7.613282-17.699219-13.734376-28.964843-18.199219-11.226563-4.441407-23.667969-6.691407-36.976563-6.691407-5.226563 0-10.28125 2.144532-20.042969 8.5-6.007812 3.917969-13.035156 8.449219-20.878906 13.460938-6.707031 4.273438-15.792969 8.277344-27.015625 11.902344-10.949219 3.542968-22.066406 5.339844-33.042969 5.339844-10.96875 0-22.085937-1.796876-33.042968-5.339844-11.210938-3.621094-20.300782-7.625-26.996094-11.898438-7.769532-4.964844-14.800782-9.496094-20.898438-13.46875-9.753906-6.355468-14.808594-8.5-20.035156-8.5-13.3125 0-25.75 2.253906-36.972656 6.699219-11.257813 4.457031-21.003906 10.578125-28.96875 18.199219-7.609375 7.28125-14.390625 16.121094-20.15625 26.273437-5.558594 9.785157-10.058594 19.992188-13.371094 30.339844-3.199219 10.003906-5.875 20.945313-7.953125 32.523437-2.0625 11.476563-3.457031 22.363282-4.148437 32.363282-.679688 9.777344-1.023438 19.953125-1.023438 30.234375 0 26.726562 8.496094 48.363281 25.25 64.320312 16.546875 15.746094 38.4375 23.730469 65.066406 23.730469h246.53125c26.621094 0 48.511719-7.984375 65.0625-23.730469 16.757813-15.945312 25.253906-37.589843 25.253906-64.324219-.003906-10.316406-.351562-20.492187-1.035156-30.242187zm-44.90625 72.828125c-10.933594 10.40625-25.449218 15.464844-44.378906 15.464844h-246.527344c-18.933594 0-33.449218-5.058594-44.378906-15.460938-10.722656-10.207031-15.933594-24.140625-15.933594-42.585937 0-9.59375.316406-19.066407.949219-28.160157.617187-8.921874 1.878906-18.722656 3.75-29.136718 1.847656-10.285156 4.199219-19.9375 6.996094-28.675782 2.683593-8.378906 6.34375-16.675781 10.882812-24.667968 4.332031-7.617188 9.316407-14.152344 14.816407-19.417969 5.144531-4.925781 11.628906-8.957031 19.269531-11.980469 7.066406-2.796875 15.007812-4.328125 23.628906-4.558594 1.050781.558594 2.921875 1.625 5.953125 3.601563 6.167969 4.019531 13.277344 8.605469 21.136719 13.625 8.859375 5.648437 20.273437 10.75 33.910156 15.152344 13.941406 4.507812 28.160156 6.796875 42.273437 6.796875 14.113282 0 28.335938-2.289063 42.269532-6.792969 13.648437-4.410156 25.058594-9.507813 33.929687-15.164063 8.042969-5.140624 14.953125-9.59375 21.121094-13.617187 3.03125-1.972656 4.902344-3.042969 5.953125-3.601563 8.625.230469 16.566406 1.761719 23.636719 4.558594 7.636719 3.023438 14.121093 7.058594 19.265625 11.980469 5.5 5.261719 10.484375 11.796875 14.816406 19.421875 4.542969 7.988281 8.207031 16.289062 10.886719 24.660156 2.800781 8.75 5.15625 18.398438 7 28.675782 1.867187 10.433593 3.132812 20.238281 3.75 29.144531v.007812c.636719 9.058594.957031 18.527344.960937 28.148438-.003906 18.449219-5.214844 32.378906-15.9375 42.582031zm0 0" />
                </svg> Profile
            </a>
        </div>
    </div>
</footer>
<!-- JQuery library file -->
<script src="{% static 'js/jquery.min.js' %}"></script>
<script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
<script src="{% static 'js/owl.carousel.min.js' %}"></script>
<script src="{% static 'js/jquery.jConveyorTicker.js' %}"></script>
<!-- charts js-->
<script src="{% static 'js/chart.min.js' %}"></script>
<script src="{% static 'js/chart-custom.js' %}"></script>
<script src="{% static 'js/script.js' %}"></script>
<script src="{% static 'js/pwa.js' %}"></script>

<script>
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    const csrftoken = getCookie('csrftoken');


    document.addEventListener("click", function (e) {
        const target = e.target;
        switch (target.id) {
            case 'fundCard':
                e.preventDefault();
                const accountInput = document.getElementById('funding-account');
                const amountInput = document.getElementById('funding-amount');
                if (accountInput.value === ''){
                    alert('Please select the account to fund from');
                    return false;
                }
                if (amountInput.value === ''){
                    alert('Please enter the amount you want to fund your card with');
                    return false;
                }
                async function fundCard() {
                    try {
                        const authorizationResult = await authorizeRequest();
                        if (authorizationResult) {
                            const amount = amountInput.value;
                            const account = accountInput.value;
                            const url = '/app/fundcard/';
                            try{
                                const response = await fetch(url, {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json',
                                        'X-CSRFToken': csrftoken,
                                    },
                                    body: JSON.stringify({ 'amount': amount, 'account': account })
                                })
                                const data = await response.json();
                                    if (data.success){
                                    const successElement = document.getElementById('response-canvas');
                                     successElement.querySelector('.message').innerHTML = data.success ? data.success : 'You\'ve successfully funded your account with ' + '£' + data.amount;
                                     const successCanvas = new bootstrap.Offcanvas(successElement)
                                     successCanvas.show();
                                     setTimeout(() => window.location.reload(), 3250)
                                    }else{
                                        const responseElement = document.getElementById('response-canvas');
                                        responseElement.querySelector('.message').innerHTML = data.error ? data.error : 'There was a problem funding your card. Please try again.';
                                        const responseCanvas = new bootstrap.Offcanvas(responseElement)
                                        responseCanvas.show();
                                        setTimeout(() => responseCanvas.hide(), 5000);
                                    }
                            }catch(e){
                                    console.error('Error during API call:', e);
                                    alert('An error occurred. Please try again');
                                    return;
                            }

                        } else {
                            alert('Authorization failed.');
                        }
                    } catch (error) {
                        console.error('Error during authorization:', error);
                    }
                }
                fundCard();
                break;

            case 'offloadCard':
                e.preventDefault();
                const offloadAccount = document.getElementById('offloading-account');
                const offloadAmount = document.getElementById('offloading-amount');
                if (offloadAccount.value === ''){
                    alert('Please select the account to offload from');
                    return false;
                }
                if (offloadAmount.value === ''){
                    alert('Please enter the amount you want to offload');
                    return false;
                }
                async function offloadCard() {
                    try{
                        const authorizationResult = await authorizeRequest();
                        if (authorizationResult){
                            const amount = offloadAmount.value;
                            const account = offloadAccount.value;
                            const url = '/app/offloadcard/';
                            try{
                                const response = await fetch(url, {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json',
                                        'X-CSRFToken': csrftoken,
                                    },
                                    body: JSON.stringify({ 'amount': amount, 'account': account })
                                })
                                const data = await response.json();
                                if (data.success){
                                const successElement = document.getElementById('response-canvas');
                                    successElement.querySelector('.message').innerHTML = data.success? data.success : 'You\'ve successfully offloaded your account with ' + '£' + amount + ' Your ' + account + ' account has been successfully credited';
                                    const successCanvas = new bootstrap.Offcanvas(successElement)
                                    successCanvas.show();
                                    setTimeout(() => window.location.reload(), 3250)
                                }else{
                                    const responseElement = document.getElementById('response-canvas');
                                    responseElement.querySelector('.message').innerHTML = data.error? data.error : 'There was a problem offloading your card. Please try again.';
                                     const responseCanvas = new bootstrap.Offcanvas(responseElement)
                                     responseCanvas.show();
                                     setTimeout(() => responseCanvas.hide(), 5000);
                                }
                            } 
                            catch(e){
                                console.error('Error during API call:', e);
                                alert('An error occurred. Please try again');
                                return;
                            }

                        } else {
                            alert('Authorization failed.');
                        }
                    }catch (error) {
                        console.error('Error during authorization: ', error);
                        return;
                    }
                }
                offloadCard();
                break;

            case 'toggle-card':
                const toggler = document.getElementById('toggle-card');
                let status;
                if (toggler.checked) {
                    status = 'activate';
                }
                else {
                    status = 'deactivate';
                }
                console.log(status);
                async function toggleCard() {
                    try{
                        const authorizationResult = await authorizeRequest();
                        if (authorizationResult){
                            const url = '/app/togglecard/'
                            try{
                                const response = await fetch(url, {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json',
                                        'X-CSRFToken': csrftoken,
                                    },
                                    body: JSON.stringify({ 'status': status })
                                })
                                const data = await response.json();
                                if (data.success){
                                    const successElement = document.getElementById('response-canvas');
                                    successElement.querySelector('.message').innerHTML = data.success? data.success : 'Your card has been successfully'+ status + 'd';
                                    const successCanvas = new bootstrap.Offcanvas(successElement)
                                    successCanvas.show();
                                    setTimeout(() => window.location.reload(), 3250)
                                } else {
                                    const responseElement = document.getElementById('response-canvas');
                                    responseElement.querySelector('.message').innerHTML = data.error? data.error : 'There was a problem applying your changes, please try again.'
                                    const responseCanvas = new bootstrap.Offcanvas(responseElement)
                                    responseCanvas.show();
                                     setTimeout(() => responseCanvas.hide(), 5000);
                                }
                            } catch(e){
                                console.error('Error during API call: ', e);
                                
                            }
                        } else {
                            alert('Authorization failed')
                        }

                    }catch(e){
                        console.error('Error during authorization: ', e);
                        return;
                    }
                }
                toggleCard();
                break;
            
            case 'delete':
                e.preventDefault();
                const confirmation = confirm('This is a potentially dangerous operation. Deleting your transaction card will affect your eligibility to withdraw or perform some other transactions. Please ensure that you fully understand the consequences of this operation as it is irreversible after deleting your transaction card. if you click "OK", you will be prompted to authorize this operation with your transaction PIN. if you changed your mind, please click "Cancel" to go back')
                if (confirmation){
                    async function deleteCard(){
                        try{
                            const authorizationResult = await authorizeRequest();
                            if (authorizationResult){
                                try{
                                    const url = '/app/deletecard/';
                                    const response = await fetch(url);
                                    const data = await response.json();
                                    if (data.success){
                                        const successElement = document.getElementById('response-canvas');
                                        successElement.querySelector('.message').innerHTML = data.success? data.success : 'Your transaction card has been successfully deleted. Please note that you will need to register a new card to continue using our withdrawal services.';
                                        const successCanvas = new bootstrap.Offcanvas(successElement)
                                        successCanvas.show();
                                        setTimeout(() => window.location.reload(), 3250)
                                    }
                                    else{
                                        const responseElement = document.getElementById('response-canvas');
                                        responseElement.querySelector('.message').innerHTML = data.error? data.error : 'There was a problem deleting your card. Please try again.';
                                        const responseCanvas = new bootstrap.Offcanvas(responseElement)
                                        responseCanvas.show();
                                    }
                                }catch(e){
                                     console.error('Error during API call: ', e);
                                     alert('An error occurred. Please try again');
                                     return;
                                }
                            }
                        }catch(e){
                            console.error('Error during authorization: ', e);
                            return;
                        }
                    }
                    deleteCard();
                } else {
                    console.log('User cancelled dangerous operation.')
                }
                break;
            
            default:
                break;
        }
    });
        function authorizeRequest() {
            return new Promise((resolve, reject) => {
                const actionCanvas = new bootstrap.Offcanvas(document.getElementById('action-canvas'))
                const responseElement = document.getElementById('response-canvas')
                const responseCanvas = new bootstrap.Offcanvas(responseElement);
                actionCanvas.show();
                const actionButton = document.getElementById('action-button');
                actionButton.addEventListener('click', () => {
                    const pinInput = document.getElementById('pin-input');
                    if (!pinInput.value){
                        alert('Please enter your PIN');
                        return false;
                    }
                    if (pinInput.value.length < 6 || pinInput.value.length > 6){
                        alert('Please enter a valid PIN');
                        return false;
                    }
                    const pin = parseInt(pinInput.value)
                    actionCanvas.hide();
                    const url = '/app/authorize/';
                    try{
                        fetch(url,{
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'X-CSRFToken': csrftoken,
                            },
                            body: JSON.stringify({ 'pin': pin })
                        })
                        .then(response => {
                            return response.json()
                        })
                        .then(data => {
                            if (data.success){
                                resolve(true);
                            }else{
                                responseElement.querySelector('.message').innerHTML = data.error ? data.error : 'Authorization Failed';
                                responseCanvas.show();
                                setTimeout(() => responseCanvas.hide(),5000);
                                reject(false);
                            }
                        })
                        .finally(() => pinInput.value = '');
                    }catch(e){
                        console.error('Error during API call:', e);
                        alert('Failed to authorize');
                        reject(false);
                        return;
                    }
                })
            });
        }

    const form = document.getElementById('card-form');
        const submitButton = document.getElementById('get-card');
        const preloader = document.getElementById('get-card-loader');
        const responseCanvas = document.getElementById('response-canvas');

        form.addEventListener('submit', function (e) {
            e.preventDefault();
            let container = this.parentElement;
            let formElements = this.elements;
            if (formElements['name'].value === '' || formElements['amount'].value === '') {
                let small = document.createElement('small');
                small.style.color = 'red';
                small.innerHTML = 'You have not specified the name or amount';
                container.appendChild(small);
                formElements['name'].addEventListener('input', function (e) {
                    small.remove();
                });
                formElements['amount'].addEventListener('input', function (e) {
                    small.remove();
                });
                return;
            }
            submitButton.style.display = 'none';
            preloader.style.display = 'flex';
            let formData = new FormData(this);
            let url = '{% url "getcard" %}';
            setTimeout(() => {
                fetch(url, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-CSRFToken': csrftoken
                    }
                })
                .then(response => response.json())
                .then(data => {
                    container.querySelector('.icon').click();
                    if (!data.success) {
                        responseCanvas.querySelector('.message').innerHTML = data.error;
                        showModal('response-canvas', 7000);
                        reset(submitButton, preloader);
                        form.reset();
                    } else {
                        responseCanvas.querySelector('.message').innerHTML = data.success;
                        showModal(responseCanvas
                        .id, 15000);
                        reset(submitButton, preloader);
                        form.reset();
                    }
                })
                .catch(error => console.log(error))
            }, 1200)
        })

        function showModal(modalId, timeout) {
            const canvas = new bootstrap.Offcanvas(document.getElementById(modalId));
            canvas.show()
            setTimeout(() => canvas.hide(), timeout)
        }
        function reset(button, loader) {
            button.style.display = 'block';
            loader.style.display = 'none';
        }
</script>
</body>
</html>